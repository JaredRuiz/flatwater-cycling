<!DOCTYPE html>
  <html>
    <head>
      <meta charset=utf-8 />
        <title>Polylines</title>
        <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
        <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.1/mapbox.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.1/mapbox.css' rel='stylesheet' />
        <style>
          body { margin:0; padding:0; }
          #map { position:absolute; top:0; bottom:0; width:100%; line-width: 0.01; }
        </style>
        <script src="array.js"></script>
        <script src="one-line-to-two.js"></script>
      </head>
      <body>
        <div id='map'></div>
        <script>
          L.mapbox.accessToken = 'pk.eyJ1Ijoic3doYzEwNjYiLCJhIjoiS2xvdHlOOCJ9.AuwjSDNFKVae2_skfgLouA';


'rgb(120, 120, 240)'

function colorToHex(color) {
    if (color.substr(0, 1) === '#') {
        return color;
    }
    var digits = /(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(color);

    var red = parseInt(digits[2]);
    var green = parseInt(digits[3]);
    var blue = parseInt(digits[4]);

    var rgb = blue | (green << 8) | (red << 16);
    return digits[1] + '#' + rgb.toString(16);
};
          

var map = L.mapbox.map('map', 'examples.map-i86nkdio');

// make a MapLine object
var ml = new MapLine(oldLine,  speedLine);

// center and zoom on map
  map.fitBounds([
	  [ml.south(), ml.west()],
	  [ml.north(), ml.east()],
  ]);

// style options for the line
var polyline_options = {
  color: '#FF0000',
  // stroke: false  
  weight: .5
};

// add line to map
for (var j = 0, max = ml.polygonPoints.length; j < max; j++) {
  var poly = L.polygon(ml.polygonPoints[j], polyline_options);
  // var poly = L.polygon(ml.polygonPoints[j], generatePOptions(ml.polygonPoints[j]));
  poly.addTo(map);
}

// mark features to scroll over
var geojson = ml.markFeatures();

// add all markers to map
var myLayer = L.mapbox.featureLayer(geojson)
// TODO still not sure how to hide markers on map...
// .setFilter(function() { return false; })
  .addTo(map);

myLayer.on('mouseover', function(e) {
    e.layer.openPopup();
});
myLayer.on('mouseout', function(e) {
    e.layer.closePopup();
});

        </script>
      </body>
    </html>


